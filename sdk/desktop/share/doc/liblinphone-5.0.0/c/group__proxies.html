<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Liblinphone: Proxies</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Liblinphone
   &#160;<span id="projectnumber">5.0.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Proxies</div>  </div>
</div><!--header-->
<div class="contents">

<p>Managing proxies.  
</p>
<p>Managing proxies. </p>
<p>User registration is controled by #LinphoneProxyConfig settings.<br  />
 Each #LinphoneProxyConfig object can be configured with registration informations like <a class="el" href="">proxy address </a> , <a class="el" href="">user id </a>, <a class="el" href="">refresh period </a>, and so on. <br  />
 A created proxy config using linphone_core_create_proxy_config(lc), once configured, must be added to #LinphoneCore using function linphone_core_add_proxy_config(). <br  />
 It is recommended to set a default <a class="el" href="">proxy config </a> using function linphone_core_set_default_proxy_config(). Once done, if <a class="el" href="">a proxy config </a> has been configured with attribute <a class="el" href="">enable register </a> , next call to linphone_core_iterate() triggers a SIP register. <br  />
 Registration status is reported by LinphoneCoreRegistrationStateChangedCb. <br  />
 <br  />
 This pseudo code demonstrates basic registration operations: <br  />
</p><div class="fragment"><div class="line">LinphoneProxyConfig* proxy_cfg;</div>
<div class="line"><span class="comment">/*create proxy config*/</span></div>
<div class="line">proxy_cfg = linphone_core_create_proxy_config(lc);</div>
<div class="line"><span class="comment">/*parse identity*/</span></div>
<div class="line">LinphoneAddress *from = linphone_address_new(<span class="stringliteral">&quot;sip:toto@sip.titi.com&quot;</span>);</div>
<div class="line">LinphoneAuthInfo *info;</div>
<div class="line"><span class="keywordflow">if</span> (password!=NULL){</div>
<div class="line">        info=linphone_auth_info_new(linphone_address_get_username(from),NULL,<span class="stringliteral">&quot;secret&quot;</span>,NULL,NULL); <span class="comment">/*create authentication structure from identity*/</span></div>
<div class="line">        linphone_core_add_auth_info(lc,info); <span class="comment">/*add authentication info to LinphoneCore*/</span></div>
<div class="line">}</div>
<div class="line"><span class="comment">// configure proxy entries</span></div>
<div class="line">linphone_proxy_config_set_identity_address(proxy_cfg,identity); <span class="comment">/*set identity with user name and domain*/</span></div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">char</span>* server_addr = linphone_address_get_domain(from); <span class="comment">/*extract domain address from identity*/</span></div>
<div class="line">linphone_proxy_config_set_server_addr(proxy_cfg,server_addr); <span class="comment">/* we assume domain = proxy server address*/</span></div>
<div class="line">linphone_proxy_config_enable_register(proxy_cfg,TRUE); <span class="comment">/*activate registration for this proxy config*/</span></div>
<div class="line">linphone_address_destroy(from); <span class="comment">/*release resource*/</span></div>
<div class="line"> </div>
<div class="line">linphone_core_add_proxy_config(lc,proxy_cfg); <span class="comment">/*add proxy config to linphone core*/</span></div>
<div class="line">linphone_core_set_default_proxy_config(lc,proxy_cfg); <span class="comment">/*set to default proxy*/</span> </div>
</div><!-- fragment --><p> <br  />
 Registration sate call back: </p><div class="fragment"><div class="line"> <span class="keyword">static</span> <span class="keywordtype">void</span> registration_state_changed(<span class="keyword">struct</span> _LinphoneCore *lc, LinphoneProxyConfig *cfg, LinphoneRegistrationState cstate, <span class="keyword">const</span> <span class="keywordtype">char</span> *message){</div>
<div class="line">                printf(<span class="stringliteral">&quot;New registration state %s for user id [%s] at proxy [%s]\n&quot;</span></div>
<div class="line">                                ,linphone_registration_state_to_string(cstate)</div>
<div class="line">                                ,linphone_proxy_config_get_identity(cfg)</div>
<div class="line">                                ,linphone_proxy_config_get_addr(cfg));</div>
<div class="line">}</div>
</div><!-- fragment --><p> <br  />
<b>Authentication:</b> <br  />
Most of the time, registration requires <a class="el" href="group__authentication.html">authentication</a> to succeed. #LinphoneAuthInfo info must be either added to #LinphoneCore using function linphone_core_add_auth_info() before #LinphoneProxyConfig is added to Linphone core, or on demand from call back #LinphoneCoreAuthInfoRequestedCb. <br  />
 <br  />
<b>Unregistration:</b> <br  />
 Unregistration or any changes to #LinphoneProxyConfig must be first started by a call to function linphone_proxy_config_edit() and validated by function linphone_proxy_config_done() <br  />
 This pseudo code shows how to unregister a user associated to a #LinphoneProxyConfig </p><div class="fragment"><div class="line">LinphoneProxyConfig* proxy_cfg;</div>
<div class="line">linphone_core_get_default_proxy(lc,&amp;proxy_cfg); <span class="comment">/* get default proxy config*/</span></div>
<div class="line">linphone_proxy_config_edit(proxy_cfg); <span class="comment">/*start editing proxy configuration*/</span></div>
<div class="line">linphone_proxy_config_enable_register(proxy_cfg,FALSE); <span class="comment">/*de-activate registration for this proxy config*/</span></div>
<div class="line">linphone_proxy_config_done(proxy_cfg); <span class="comment">/*initiate REGISTER with expire = 0*/</span></div>
</div><!-- fragment --><p> <br  />
 A complete tutorial can be found at : Registration tutorial </p>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
